<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mobile First – 20% Menu / 80% Body + Playground</title>
  <link rel="stylesheet" href="index3.css" />
</head>
<body class="state-compact">
  <!-- 3-state toggle: Hidden → 20% → 100% -->
  <button id="menudisplay" aria-label="Toggle menu">☰</button>

  <!-- Left menu (white) -->
  <nav class="menuBarstdy" aria-label="Study Menu">
    <div class="menuHeader">
      <div class="menuTitle">Study Menu</div>
    </div>

    <div class="menustudycategorycontainer open">
      <button class="menustudycategory" aria-expanded="true">
        <span class="menustudytxtheader">Set up</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
      </button>
      <div class="menustudy" role="region" aria-label="Set up">
        <a class="menustudytxt" href="#">Set up</a>
        <a class="menustudytxt" href="#">Set up on desktop</a>
        <a class="menustudytxt" href="#">Set up on android</a>
        <a class="menustudytxt" href="#">Set up on iphone</a>
      </div>
    </div>

    <div class="menustudycategorycontainer">
      <button class="menustudycategory" aria-expanded="false">
        <span class="menustudytxtheader">What is HTML?</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
      </button>
      <div class="menustudy" role="region" aria-label="What is HTML?">
        <a class="menustudytxt" href="#">Overview</a>
        <a class="menustudytxt" href="#">Elements & Tags</a>
        <a class="menustudytxt" href="#">Attributes</a>
        <a class="menustudytxt" href="#">Semantic HTML</a>
      </div>
    </div>

    <div class="menustudycategorycontainer">
      <button class="menustudycategory" aria-expanded="false">
        <span class="menustudytxtheader">How to learn</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
      </button>
      <div class="menustudy" role="region" aria-label="How to learn">
        <a class="menustudytxt" href="#">Roadmap</a>
        <a class="menustudytxt" href="#">Practice</a>
        <a class="menustudytxt" href="#">Projects</a>
        <a class="menustudytxt" href="#">Resources</a>
      </div>
    </div>
  </nav>

  <!-- Main content (80%) -->
  <main class="mainbody" role="main">
    <div class="contentCard">
      <h1>Coding Playground (HTML + CSS)</h1>
      <p>Type HTML and CSS below and view the result live. Toggle <em>Auto-run</em> or press <strong>Run ▶</strong>.</p>

      <!-- PLAYGROUND -->
      <section class="playground" aria-label="HTML and CSS playground">
        <div class="pg-controls">
          <label class="pg-checkbox">
            <input id="autoRun" type="checkbox" checked>
            <span>Auto-run</span>
          </label>

          <div class="pg-actions">
            <button id="runBtn" class="btn" title="Run (Ctrl+Enter)">Run ▶</button>
            <button id="resetBtn" class="btn" title="Reset to template">Reset</button>
            <button id="downloadBtn" class="btn" title="Download as single HTML file">Download</button>
          </div>
        </div>

        <div class="pg-grid">
          <div class="editor-wrap">
            <div class="editor-head">
              <span>HTML</span>
              <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to run
            </div>
            <textarea id="htmlInput" class="editor" spellcheck="false" aria-label="HTML input"></textarea>
          </div>

          <div class="editor-wrap">
            <div class="editor-head">
              <span>CSS</span>
              <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to run
            </div>
            <textarea id="cssInput" class="editor" spellcheck="false" aria-label="CSS input"></textarea>
          </div>

          <div class="preview-wrap">
            <div class="preview-head">
              <span>Preview</span>
            </div>
            <iframe id="preview" class="preview" title="Result preview" sandbox="allow-same-origin allow-forms allow-pointer-lock allow-popups allow-scripts"></iframe>
          </div>
        </div>

        <div id="statusBar" class="pg-status" role="status" aria-live="polite">Ready.</div>
      </section>
      <!-- /PLAYGROUND -->
    </div>
  </main>

  <script>

    /* ===== Menu: 3-state toggle (Hidden → 20% → 100%) ===== */
(() => {
  const body = document.body;
  const btn = document.getElementById('menudisplay');
  const states = ['hidden', 'compact', 'full'];

  // Determine initial
  const current = Array.from(body.classList).find(c => c.startsWith('state-')) || 'state-compact';
  let idx = Math.max(0, states.indexOf(current.replace('state-', '')));
  if (idx === -1) idx = 1;

  const apply = () => {
    states.forEach(s => body.classList.remove('state-' + s));
    body.classList.add('state-' + states[idx]);
    btn.setAttribute('aria-label', `Menu: ${states[idx]}. Tap to change`);
    btn.title = `Menu: ${states[idx]}`;
  };
  apply();

  btn.addEventListener('click', () => {
    idx = (idx + 1) % states.length;
    apply();
  });

  // Keyboard: press "m" to cycle
  window.addEventListener('keydown', (e) => {
    if (!e.metaKey && !e.ctrlKey && !e.altKey && e.key.toLowerCase() === 'm') {
      idx = (idx + 1) % states.length;
      apply();
    }
  });
})();

/* ===== Collapsible categories ===== */
(() => {
  const groups = document.querySelectorAll('.menustudycategorycontainer');
  groups.forEach(group => {
    const headerBtn = group.querySelector('.menustudycategory');
    const panel = group.querySelector('.menustudy');

    const toggle = () => {
      const isOpen = group.classList.toggle('open');
      headerBtn.setAttribute('aria-expanded', String(isOpen));
      if (isOpen) {
        const firstLink = panel.querySelector('a');
        if (firstLink) firstLink.focus({ preventScroll: true });
      }
    };

    headerBtn.addEventListener('click', (e) => {
      e.preventDefault();
      toggle();
    });

    headerBtn.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggle();
      }
    });
  });
})();

/* ===== HTML + CSS Playground ===== */
(() => {
  const htmlInput = document.getElementById('htmlInput');
  const cssInput  = document.getElementById('cssInput');
  const iframe    = document.getElementById('preview');
  const autoRun   = document.getElementById('autoRun');
  const runBtn    = document.getElementById('runBtn');
  const resetBtn  = document.getElementById('resetBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const statusBar = document.getElementById('statusBar');

  const LS_HTML_KEY = 'pg_html_v1';
  const LS_CSS_KEY  = 'pg_css_v1';

  const templateHTML =
`<main>
  <h1>Hello, World!</h1>
  <p>Edit the HTML and CSS, then run.</p>
  <button class="primary">Click me</button>
</main>`;
  const templateCSS =
`html, body { margin: 0; padding: 12px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
main { max-width: 600px; margin: 0 auto; line-height: 1.6; }
h1 { color: #111827; }
.primary {
  background: #2563eb; color: #fff; border: 0; border-radius: 10px;
  padding: 10px 14px; cursor: pointer;
}
.primary:active { transform: translateY(1px); }`;

  // Load from localStorage or defaults
  htmlInput.value = localStorage.getItem(LS_HTML_KEY) ?? templateHTML;
  cssInput.value  = localStorage.getItem(LS_CSS_KEY)  ?? templateCSS;

  const buildDoc = (html, css) =>
`<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>${css}</style>
</head>
<body>
${html}
</body>
</html>`;

  const updateStatus = (msg) => {
    statusBar.textContent = msg;
  };

  // Render into iframe via srcdoc
  const render = () => {
    const html = htmlInput.value;
    const css  = cssInput.value;
    iframe.srcdoc = buildDoc(html, css);
    updateStatus(`Rendered ${new Date().toLocaleTimeString()}.`);
  };

  // Debounce for auto-run typing
  let t = null;
  const debounce = (fn, delay=300) => {
    if (t) clearTimeout(t);
    t = setTimeout(fn, delay);
  };

  // Auto-save on change
  const save = () => {
    localStorage.setItem(LS_HTML_KEY, htmlInput.value);
    localStorage.setItem(LS_CSS_KEY, cssInput.value);
  };

  // Events
  htmlInput.addEventListener('input', () => {
    save();
    if (autoRun.checked) debounce(render);
  });
  cssInput.addEventListener('input', () => {
    save();
    if (autoRun.checked) debounce(render);
  });

  // Run button & keyboard shortcut
  runBtn.addEventListener('click', render);
  [htmlInput, cssInput].forEach(el => {
    el.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();
        render();
      }
    });
  });

  // Reset template
  resetBtn.addEventListener('click', () => {
    htmlInput.value = templateHTML;
    cssInput.value  = templateCSS;
    save();
    render();
    updateStatus('Reset to template.');
  });

  // Download single .html file with embedded CSS
  downloadBtn.addEventListener('click', () => {
    const html = buildDoc(htmlInput.value, cssInput.value);
    const blob = new Blob([html], {type: 'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.download = 'playground.html';
    a.href = url;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
    updateStatus('Downloaded playground.html');
  });

  // Initial render
  render();
})();

  </script>
</body>
</html>
