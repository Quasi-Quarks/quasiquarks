<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solar Power & Energy Calculator</title>
  <style>
    :root{
      --bg:#0b1220;         /* deep navy */
      --card:#111a2e;       /* card background */
      --muted:#8892a6;      /* secondary text */
      --text:#e6eefc;       /* main text */
      --accent:#34d399;     /* teal-green */
      --accent-2:#60a5fa;   /* blue */
      --danger:#f87171;     /* red */
      --ring: 0 0 0 3px rgba(52,211,153,.25);
      --radius:16px;
      --shadow:0 10px 24px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji','Segoe UI Emoji';
      background: radial-gradient(1200px 600px at 70% -10%, #1b2a4a 0%, var(--bg) 40%) no-repeat fixed;
      color:var(--text);
      -webkit-font-smoothing: antialiased;
    }
    .wrap{max-width:980px;margin-inline:auto;padding:16px;}

    header{
      display:flex;gap:12px;align-items:center;justify-content:space-between;margin:10px 0 18px;
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:38px;height:38px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:var(--shadow);display:grid;place-items:center;font-weight:800;color:#0c172b}
    h1{font-size:1.15rem;margin:0;line-height:1.1}
    h1 small{display:block;color:var(--muted);font-weight:500;margin-top:4px}
    .pill{font-size:.8rem;color:var(--bg);background:linear-gradient(135deg,var(--accent),#9ae6b4);padding:.4rem .7rem;border-radius:999px;font-weight:700}

    .grid{display:grid;gap:14px}
    @media(min-width:900px){.grid{grid-template-columns: 360px 1fr}}

    .card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:var(--shadow)}
    .card h2{margin:0;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.06);font-size:1rem}
    .card .content{padding:14px 16px}

    label{display:block;font-size:.85rem;color:var(--muted);margin-bottom:6px}
    input,select,button{font:inherit}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .row-3{display:grid;grid-template-columns:1.2fr .8fr .8fr;gap:10px}
    .row-4{display:grid;grid-template-columns:1.2fr .8fr .8fr .8fr;gap:10px}

    .input{display:flex;align-items:center;background:#0c1527;border:1px solid rgba(255,255,255,.08);border-radius:12px}
    .input input{appearance:none;border:0;background:transparent;color:var(--text);padding:12px 12px;width:100%;outline:none}
    .input span{color:var(--muted);padding-right:10px}
    .input:focus-within{box-shadow:var(--ring);border-color:rgba(52,211,153,.45)}

    .btn{display:inline-flex;align-items:center;gap:.55rem;background:linear-gradient(135deg,var(--accent),#22c55e);border:0;color:#062113;font-weight:800;padding:.8rem 1rem;border-radius:12px;cursor:pointer}
    .btn.secondary{background:#0e1a32;color:var(--text);border:1px solid rgba(255,255,255,.08)}
    .btn.ghost{background:transparent;border:1px dashed rgba(255,255,255,.18);color:var(--muted)}
    .btn:active{transform:translateY(1px)}

    .appliance-list{display:flex;flex-direction:column;gap:10px}
    .item{display:grid;grid-template-columns:1fr auto;align-items:center;padding:12px;border:1px solid rgba(255,255,255,.06);border-radius:12px;background:#0b152b}
    .meta{font-size:.9rem;color:var(--muted)}
    .actions{display:flex;gap:8px}
    .chip{font-weight:700;background:rgba(52,211,153,.12);color:#a7f3d0;border:1px solid rgba(52,211,153,.35);padding:.2rem .5rem;border-radius:999px}
    .chip.blue{background:rgba(96,165,250,.12);color:#bfdbfe;border:1px solid rgba(96,165,250,.35)}

    .totals{display:grid;gap:10px}
    .stat{background:#0b152b;border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:12px}
    .stat h3{margin:0;font-size:.9rem;color:var(--muted)}
    .stat .big{font-size:1.25rem;font-weight:800;margin-top:4px}

    .note{color:var(--muted);font-size:.85rem}
    .footer{color:var(--muted);text-align:center;padding:18px 0;font-size:.85rem}
    .danger{color:var(--danger)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">‚òÄÔ∏è</div>
        <h1>
          Solar Power & Energy
          <small>Mobile‚Äëfirst calculator for quick sizing</small>
        </h1>
      </div>
      <span class="pill">v1.0</span>
    </header>

    <div class="grid">
      <!-- LEFT: Inputs -->
      <section class="card" aria-labelledby="inputs-title">
        <h2 id="inputs-title">Inputs</h2>
        <div class="content">
          <div class="row">
            <div>
              <label for="sun-hours">Peak Sun Hours / day</label>
              <div class="input">
                <input id="sun-hours" type="number" min="0" step="0.1" value="5" inputmode="decimal" />
                <span>hrs</span>
              </div>
            </div>
            <div>
              <label for="losses">System Losses</label>
              <div class="input">
                <input id="losses" type="number" min="0" max="60" step="1" value="20" />
                <span>%</span>
              </div>
            </div>
          </div>

          <div class="row-4" style="margin-top:10px">
            <div>
              <label for="name">Appliance</label>
              <div class="input"><input id="name" placeholder="e.g., LED Bulb" /></div>
            </div>
            <div>
              <label for="watts">Power</label>
              <div class="input"><input id="watts" type="number" min="0" step="1" placeholder="10" inputmode="numeric" /><span>W</span></div>
            </div>
            <div>
              <label for="qty">Qty</label>
              <div class="input"><input id="qty" type="number" min="1" step="1" value="1" inputmode="numeric" /></div>
            </div>
            <div>
              <label for="hours">Use / day</label>
              <div class="input"><input id="hours" type="number" min="0" step="0.5" value="1" inputmode="decimal" /><span>h</span></div>
            </div>
          </div>

          <div style="display:flex; gap:8px; margin-top:12px;flex-wrap:wrap">
            <button class="btn" id="add"><span>Ôºã</span>Add appliance</button>
            <button class="btn secondary" id="presetLights">üí° Quick: 5√ó10‚ÄØW lights √ó 4‚ÄØh</button>
            <button class="btn ghost" id="clearAll">üóë Clear list</button>
          </div>

          <p class="note" style="margin-top:10px">Tip: <em>Power</em> (W) √ó <em>time</em> (h) = <strong>Energy</strong> (Wh). Use realistic hours/day for each appliance.</p>
        </div>
      </section>

      <!-- RIGHT: List & Results -->
      <section class="card" aria-labelledby="list-title">
        <h2 id="list-title">Appliances & Results</h2>
        <div class="content">
          <div id="list" class="appliance-list" aria-live="polite"></div>

          <div class="totals" style="margin-top:12px">
            <div class="stat">
              <h3>Peak load (all on at once)</h3>
              <div class="big"><span id="peakW">0</span> W</div>
            </div>
            <div class="stat">
              <h3>Daily energy use (sum of W√óh)</h3>
              <div class="big"><span id="dailyWh">0</span> Wh <span class="meta">(<span id="dailyKWh">0.000</span> kWh)</span></div>
            </div>
            <div class="stat">
              <h3>Energy from peak load over sun hours</h3>
              <div class="big"><span id="peakEnergy">0</span> Wh <span class="meta">= peakW √ó sunHours</span></div>
            </div>
            <div class="stat">
              <h3>Panel power to meet daily energy</h3>
              <div class="big"><span id="panelW">0</span> W <span class="meta">‚âà dailyWh √∑ (sunHours √ó (1‚àíloss))</span></div>
            </div>
          </div>

          <p class="note" style="margin-top:8px">Assumes system losses include wiring, controller, temperature, dust, DC‚ÜíAC, etc. Adjust to your case.</p>
        </div>
      </section>
    </div>

    <p class="footer">Made for phones ‚Äî works great on desktop too. Store is local to your browser.</p>
  </div>

  <script>
  ;(() => {
    /** @typedef {{id:string,name:string,watts:number,qty:number,hours:number}} Item */
    const $ = (sel,root=document)=>root.querySelector(sel)
    const listEl = $('#list')
    const sunHoursEl = $('#sun-hours')
    const lossesEl = $('#losses')

    const peakWEl = $('#peakW')
    const dailyWhEl = $('#dailyWh')
    const dailyKWhEl = $('#dailyKWh')
    const peakEnergyEl = $('#peakEnergy')
    const panelWEl = $('#panelW')

    /** Local storage */
    const KEY='solar_calc_items_v1'
    /** @type {Item[]} */
    let items = []

    const readNum = (el, fallback=0)=>{
      const v = parseFloat(el.value)
      return Number.isFinite(v) ? v : fallback
    }

    function uuid(){ return Math.random().toString(36).slice(2,9) }

    function load(){
      try{ items = JSON.parse(localStorage.getItem(KEY)||'[]') }catch{ items=[] }
      render()
    }

    function save(){ localStorage.setItem(KEY, JSON.stringify(items)) }

    function addItem(name, watts, qty, hours){
      if(!name || watts<=0 || qty<=0){ return toast('Please enter a name, power (>0) and quantity (>0).',true) }
      items.push({id:uuid(), name: name.trim(), watts: +watts, qty: +qty, hours: Math.max(0,+hours||0)})
      save(); render(); clearInputs()
    }

    function clearInputs(){
      $('#name').value=''
      $('#watts').value=''
      $('#qty').value='1'
      $('#hours').value='1'
      $('#name').focus()
    }

    function removeItem(id){ items = items.filter(i=>i.id!==id); save(); render() }

    function editItem(id){
      const it = items.find(i=>i.id===id); if(!it) return
      const name = prompt('Appliance name', it.name); if(name===null) return
      const watts = +prompt('Power (W)', it.watts)
      const qty   = +prompt('Quantity', it.qty)
      const hours = +prompt('Hours per day', it.hours)
      if(!name || !Number.isFinite(watts) || watts<=0 || !Number.isFinite(qty) || qty<=0 || !Number.isFinite(hours) || hours<0){
        return toast('Invalid values. Edit cancelled.', true)
      }
      Object.assign(it,{name:name.trim(), watts, qty, hours}); save(); render()
    }

    function render(){
      listEl.innerHTML = ''
      if(items.length===0){
        const empty = document.createElement('div')
        empty.className='item'
        empty.innerHTML = `<div>
          <strong>No appliances yet</strong><div class="meta">Add some above ‚Äî e.g., a 100 W TV used 3 h/day.</div>
        </div>`
        listEl.appendChild(empty)
      } else {
        for(const it of items){
          const div = document.createElement('div')
          div.className='item'
          const energy = it.watts * it.qty * it.hours
          div.innerHTML = `
            <div>
              <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap">
                <strong>${escapeHtml(it.name)}</strong>
                <span class="chip">${it.watts} W</span>
                <span class="chip blue">√ó ${it.qty}</span>
                <span class="meta">for ${it.hours} h/day ‚Üí <b>${Math.round(energy)}</b> Wh/day</span>
              </div>
            </div>
            <div class="actions">
              <button class="btn secondary" aria-label="Edit" title="Edit" onclick="editItem('${it.id}')">‚úèÔ∏è</button>
              <button class="btn ghost" aria-label="Remove" title="Remove" onclick="removeItem('${it.id}')">‚úñ</button>
            </div>`
          listEl.appendChild(div)
        }
      }
      compute()
    }

    function compute(){
      const sunHours = clamp(readNum(sunHoursEl, 5), 0, 24)
      const lossPct  = clamp(readNum(lossesEl, 20), 0, 60)

      const peakW = items.reduce((s,i)=> s + i.watts * i.qty, 0)
      const dailyWh = items.reduce((s,i)=> s + i.watts * i.qty * i.hours, 0)
      const peakEnergyWh = peakW * sunHours
      const derate = 1 - (lossPct/100)
      const panelW = derate>0 && sunHours>0 ? Math.ceil(dailyWh / (sunHours * derate)) : 0

      peakWEl.textContent = Math.round(peakW)
      dailyWhEl.textContent = Math.round(dailyWh)
      dailyKWhEl.textContent = (dailyWh/1000).toFixed(3)
      peakEnergyEl.textContent = Math.round(peakEnergyWh)
      panelWEl.textContent = panelW
    }

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)) }

    function toast(msg, isErr=false){
      const el = document.createElement('div')
      el.role='status'
      el.style.cssText='position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:'+ (isErr?'#3b0b0b':'#0b2b1a') +';border:1px solid rgba(255,255,255,.15);color:#fff;padding:10px 14px;border-radius:12px;box-shadow:var(--shadow);z-index:9999;'
      el.textContent=msg
      document.body.appendChild(el)
      setTimeout(()=> el.remove(), 2200)
    }

    function escapeHtml(s){
      return s.replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]))
    }

    // expose edit/remove for inline handlers
    window.editItem = editItem
    window.removeItem = removeItem

    // wiring
    $('#add').addEventListener('click', () => {
      addItem(
        $('#name').value,
        +$('#watts').value,
        +$('#qty').value,
        +$('#hours').value
      )
    })

    $('#presetLights').addEventListener('click', () => {
      addItem('LED bulb', 10, 5, 4)
    })

    $('#clearAll').addEventListener('click', () => {
      if(confirm('Clear all appliances?')){ items = []; save(); render() }
    })

    sunHoursEl.addEventListener('input', compute)
    lossesEl.addEventListener('input', compute)

    // init
    load()
  })()
  </script>
</body>
</html>
